import requests
import sys

# Check if ENTITY_ID is passed as an argument
if len(sys.argv) > 1:
    entity_id = sys.argv[1]
else:
    raise ValueError("No ENTITY_ID provided")

# URL encode the ENTITY_ID
encoded_entity_id = entity_id.replace(":", "%3A")

url = f"https://api.eu1.dome9.com/v2/vulnerability/scan-results?EntityType=Image&EntityId={encoded_entity_id}"

headers = {
    "accept": "application/json",
    "authorization": "Basic YjA1NGE5NWUtZDhlNy00ZmNlLWJmMDctMWFhMjI3NmI4Zjc5Omkxc2R5dHhkb2lpeW44b2hiODd1Z2tmbg=="
}

response = requests.get(url, headers=headers)

print(response.text)
