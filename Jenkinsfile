pipeline {
    agent any

    parameters {
        string(name: 'ENTITY_ID', defaultValue: '', description: 'Enter Entity ID')
        string(name: 'NAME', defaultValue: '', description: 'Enter Name')
    }

    stages {
        stage('Parameter Input') {
            steps {
                script {
                    echo "Entity ID: ${params.ENTITY_ID}"
                    echo "Name: ${params.NAME}"
                }
            }
        }

        stage('API Call') {
            steps {
                script {
                    // Replace 'ENTITY_ID_PLACEHOLDER' with the actual entity ID from the input
                    def apiURL = "https://api.eu1.dome9.com/v2/vulnerability/scan-results?EntityType=Image&EntityId=${params.ENTITY_ID}".replaceAll(':', '%3A')

                    // Execute the curl command
                    sh "curl --request GET \
                        --url '${apiURL}' \
                        --header 'accept: application/json' \
                        --header 'authorization: Basic YjA1NGE5NWUtZDhlNy00ZmNlLWJmMDctMWFhMjI3NmI4Zjc5Omkxc2R5dHhkb2lpeW44b2hiODd1Z2tmbg=='"
                }
            }
        }
    }
}
